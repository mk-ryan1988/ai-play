@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Light Mode - darker colors for background layers */
    --color-primary: theme('colors.neutral.100');
    --color-secondary: theme('colors.neutral.50');
    --color-tertiary: theme('colors.white');
    --color-sidemenu: theme('colors.neutral.50');

    --text-title: theme('colors.neutral.900');
    --text-subtitle: theme('colors.neutral.700');
    --text-body: theme('colors.neutral.600');
    --text-label: theme('colors.neutral.500');

    /* Accent/Brand Colors */
    --color-accent: theme('colors.blue.600');
    --color-accent-hover: theme('colors.blue.700');
    --color-accent-text: theme('colors.white');

    /* Semantic Colors */
    --color-success: theme('colors.green.600');
    --color-success-light: theme('colors.green.50');
    --color-warning: theme('colors.yellow.600');
    --color-warning-light: theme('colors.yellow.50');
    --color-error: theme('colors.red.600');
    --color-error-light: theme('colors.red.50');
    --color-info: theme('colors.blue.600');
    --color-info-light: theme('colors.blue.50');

    /* Border Radius */
    --radius-sm: 0.125rem;
    --radius-md: 0.375rem;
    --radius-lg: 0.5rem;
    --radius-xl: 0.75rem;
    --radius-2xl: 1rem;
    --radius-full: 9999px;

    /* Shadows - hierarchical (primary=cards, secondary=buttons, tertiary=inputs) */
    --shadow-primary: none;
    --shadow-secondary: none;
    --shadow-tertiary: none;

    /* Typography */
    --font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;

    /* Borders - hierarchical (primary=cards, secondary=buttons, tertiary=inputs) */
    --border-primary: 1px solid theme('colors.neutral.200');
    --border-secondary: 1px solid theme('colors.neutral.200');
    --border-tertiary: 1px solid theme('colors.neutral.200');
  }

  @media (prefers-color-scheme: dark) {
    :root {
      /* Dark Mode - lighter colors for foreground layers */
      --color-primary: theme('colors.neutral.950');
      --color-secondary: theme('colors.neutral.900');
      --color-tertiary: theme('colors.neutral.800');
      --color-sidemenu: theme('colors.neutral.900');

      --text-title: theme('colors.white');
      --text-subtitle: theme('colors.neutral.200');
      --text-body: theme('colors.neutral.300');
      --text-label: theme('colors.neutral.400');

      /* Accent/Brand Colors */
      --color-accent: theme('colors.blue.500');
      --color-accent-hover: theme('colors.blue.400');
      --color-accent-text: theme('colors.white');

      /* Semantic Colors */
      --color-success: theme('colors.green.500');
      --color-success-light: theme('colors.green.950');
      --color-warning: theme('colors.yellow.500');
      --color-warning-light: theme('colors.yellow.950');
      --color-error: theme('colors.red.500');
      --color-error-light: theme('colors.red.950');
      --color-info: theme('colors.blue.500');
      --color-info-light: theme('colors.blue.950');

      /* Border Radius - same as light mode */
      /* Shadows - hierarchical, darker for dark mode */
      --shadow-primary: none;
      --shadow-secondary: none;
      --shadow-tertiary: none;

      /* Typography - same as light mode */
      --font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;

      /* Borders - hierarchical */
      --border-primary: 1px solid theme('colors.neutral.700');
      --border-secondary: 1px solid theme('colors.neutral.700');
      --border-tertiary: 1px solid theme('colors.neutral.700');
    }
  }

  body {
    @apply bg-primary text-body;
    font-family: var(--font-family);
  }

  /* Custom Scrollbar Styling */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--color-tertiary) transparent;
  }

  *::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  *::-webkit-scrollbar-track {
    background: transparent;
    border-radius: var(--radius-full);
  }

  *::-webkit-scrollbar-thumb {
    background: var(--color-tertiary);
    border-radius: var(--radius-full);
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  *::-webkit-scrollbar-thumb:hover {
    background: var(--text-label);
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  *::-webkit-scrollbar-corner {
    background: transparent;
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }

  /* Hierarchical border utilities */
  .border-primary {
    border: var(--border-primary);
  }
  .border-secondary {
    border: var(--border-secondary);
  }
  .border-tertiary {
    border: var(--border-tertiary);
  }

  /* Directional border utilities */
  .border-b-tertiary {
    border-bottom: var(--border-tertiary);
  }
  .border-t-tertiary {
    border-top: var(--border-tertiary);
  }

  /* Hierarchical shadow utilities */
  .shadow-primary {
    box-shadow: var(--shadow-primary);
  }
  .shadow-secondary {
    box-shadow: var(--shadow-secondary);
  }
  .shadow-tertiary {
    box-shadow: var(--shadow-tertiary);
  }
}

@keyframes typing {
  from { width: 0 }
  to { width: 100% }
}

@keyframes blink-caret {
  from, to { border-color: transparent }
  50% { border-color: black }
}

/* Streaming cursor for chat messages */
@keyframes cursor-blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

.streaming-cursor {
  display: inline-block;
  width: 2px;
  height: 1.1em;
  background-color: currentColor;
  margin-left: 2px;
  vertical-align: text-bottom;
  animation: cursor-blink 1s step-end infinite;
}

/* Typing text animation for streaming messages */
.typing-text {
  animation: typing-pulse 1.5s ease-in-out infinite;
}

@keyframes typing-pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

.ProseMirror {
  min-height: 100px;
  color: theme('colors.title');
  padding: 1rem;
}

.ProseMirror:focus {
  outline: none;
}

.ProseMirror p.is-editor-empty:first-child::before {
  color:#413f3f;
  content: attr(data-placeholder);
  float: left;
  height: 0;
  pointer-events: none;
}

/* List Styles */
.ProseMirror ul {
  list-style-type: disc;
  padding-left: 1.5em;
}

.ProseMirror ol {
  list-style-type: decimal;
  padding-left: 1.5em;
}

.ProseMirror ul li,
.ProseMirror ol li {
  margin: 0.5em 0;
}

/* Heading Styles */
.ProseMirror h1 {
  font-size: 1.5em;
  font-weight: bold;
  margin: 1em 0 0.5em;
}

.ProseMirror h2 {
  font-size: 1.3em;
  font-weight: bold;
  margin: 1em 0 0.5em;
}

/* Blockquote Styles */
.ProseMirror blockquote {
  border-left: 3px solid theme('colors.tertiary');
  padding-left: 1em;
  margin-left: 0;
  font-style: italic;
}

/* Horizontal Rule */
.ProseMirror hr {
  border: none;
  border-top: 2px solid theme('colors.tertiary');
  margin: 2em 0;
}

.ProseMirror {
  /* Task list specific styles */
  ul[data-type="taskList"] {
    list-style: none;
    margin-left: 0;
    padding: 0;

    li {
      align-items: flex-start;
      display: flex;

      > label {
        flex: 0 0 auto;
        margin-right: 0.5rem;
        user-select: none;
      }

      > div {
        flex: 1 1 auto;
      }
    }

    input[type="checkbox"] {
      cursor: pointer;
    }

    ul[data-type="taskList"] {
      margin: 0;
    }
  }
}


.scrollbar-hide {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;     /* Firefox */
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;  /* Chrome, Safari and Opera */
}

.scroll-snap-x-proximity {
  scroll-snap-type: x proximity;
}

.scroll-snap-start {
  scroll-snap-align: start;
}

/* items list */
.items {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 0.5rem;
  border: 1px solid var(--color-tertiary);
  border-radius: 0.5rem;
  background-color: var(--color-secondary);
  padding: 0.5rem;
  justify-items: start;

  .items {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));

    &:hover {
      border-color: var(--color-primary);
    }
  }
}

@keyframes slide-in-from-bottom-right {
  from {
    opacity: 0;
    transform: translate(25%, 25%) scale(0.5);
  }
  to {
    opacity: 1;
    transform: translate(0, 0) scale(1);
  }
}

@keyframes slide-out-to-bottom-right {
  from {
    opacity: 1;
    transform: translate(0, 0) scale(1);
  }
  to {
    opacity: 0;
    transform: translate(25%, 25%) scale(0.5);
  }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

/* Form Input Styles */
.form-input {
  @apply w-full px-3 py-2 rounded-md border border-primary bg-tertiary
    focus:outline-none focus:ring-2 focus:ring-blue-500
    disabled:bg-gray-100 disabled:cursor-not-allowed;

    &.prefix {
      @apply pl-14;
    }
}

.form-label {
  @apply block text-sm font-medium text-gray-700 mb-1;
}

.form-error {
  @apply text-sm text-red-500 mt-1;
}

.form-group {
  @apply mb-4;
}

/* remove disables input bg */
.form-input:disabled {
  @apply bg-transparent
}

/* Sidebar Styles */
@layer sidebar {
  .sidebar-hidden {
    transform: translateX(calc(-100% - 8px));
  }

  .sidebar-visible {
    transform: translateX(0);
  }
}

/* Sidebar Toggle Styles */
@layer tree-toggle {
  .tree-toggle {
    position: relative;
    width: 44px;
    height: 44px;
    display: grid;
    place-items: center;
    border-radius: 8px;
    border-width: 0px;
    background: #0000;
    cursor: pointer;
    outline-color: theme('colors.red.500');
    color: var(--text-label);
  }

  .tree-toggle:hover {
    color: var(--text-title);
  }

  .tree-toggle::after {
    content: '';
    background: theme('colors.tertiary');
    opacity: 0;
    position: absolute;
    inset: 8px;
    pointer-events: none;
    border-radius: 8px;
    transition: opacity 0.12s ease-out;
  }

  .tree-toggle .icon-bar {
    transform-box: fill-box;
    transform-origin: 0 50%;
    scale: 0.3 1;
    transition: scale 0.16s cubic-bezier(0.0, 0.0, 0.58, 1.0);
  }

  .tree-toggle[aria-expanded="true"] .icon-bar {
    scale: 1 1;
  }

  .tree-toggle:hover .icon-bar {
    scale: 1 1;
  }

  .tree-toggle[aria-expanded="true"]:hover .icon-bar {
    scale: 0.3 1;
  }

  .tree-toggle svg {
    width: 22px;
  }

  /* Safety triangle and hover set */
  .tree-toggle .hover-set,
  .tree-toggle .safety-triangle {
    transition: scale 0.16s 0.16s cubic-bezier(0.0, 0.0, 0.58, 1.0);
    opacity: 0;
    pointer-events: none;
  }

  .tree-toggle .hover-set {
    pointer-events: all;
  }

  .tree-toggle:hover .safety-triangle {
    pointer-events: all;
  }

  .tree-toggle[aria-expanded="true"] .hover-set,
  .tree-toggle[aria-expanded="true"] .safety-triangle {
    scale: 0;
    transition-delay: 0s;
  }

  .tree-toggle .safety-triangle {
    display: inline-block;
    width: 260px;
    top: 0;
    bottom: 0;
    background: repeating-linear-gradient(45deg, #0000 0 4px, theme('colors.red.500') 4px 5px);
    position: absolute;
    left: 0;
    transform-origin: calc(0.5rem + 22px) 50%;
    translate: -0.5rem 0;
    clip-path: polygon(0 100%, 0.5rem 0, calc(0.5rem + 44px) 0, 100% 100%);
    z-index: 2;
    opacity: 0;
  }

  .tree-toggle .hover-set {
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: repeating-linear-gradient(45deg, #000 0 4px, hsl(140 80% 50%) 4px 5px);
  }
}
